# ORIGIN-GEN1硬件设计概览

## 模块

### 物理接口

物理接口定义如下

### 协议

- **有线通讯**

  主机与模块间的有线通讯使用标准SPI协议，通过ESP32的SPI2接口。时钟极性和相位可以在模块的驱动程序中指定。通讯速率最高可达80M(ESP32S3限制)。由于受到各种条件的限制，通讯速率可能达不到最高，在模块的初始化时会测试最高的连接速率，之后与该模块之间就以这个速率通信。当然，模块驱动也可以手动降低或提高通信速率，但过高的速率可能造成意料之外的问题。

- **无线通讯**

  ESP32S3的WiFi功能暂时闲置，若SPI通讯速率过低，可调起WiFi辅助通信。

- **设计规范**

  参照模块设计规范

## 电源

### 线路

- **VBUS电源总线**

  VBUS是整个系统的电源总线，连通主机和其他模块，并为它们提供电力。

  规定VBUS上电压为5V，主机VBUS载流最大6A（指流过的电流而非能提供的电流）

- **后备电池线路**

  后备电池线路是当系统休眠后为芯片组供电的线路。该线路可以为芯片组和板载灯光供电，但不能为VBUS供电。

### 电源管理

- **芯片组**

  该主板的芯片组可以通过后备电池或电源总线供电，通过DC-DC控制器将1.8V~5V的电压转换为3.3V。可以通过软件选择供电方式。为了能在休眠时能够唤醒外部电池模块等，硬件强制必须选择一种方式供电，不能断开芯片组的电源。

- **灯光**

  灯光和芯片组电源共用供电线路，但有独立的DC-DC控制器，可以由软件单独关断。

- **后备电池充电**

  后备电池以VBUS作为电源充电，可由软件控制关断充电。

**注意:**

1. 若后备电池失效导致芯片组电源断开，以下的电源配置选项将被硬件自动选中：芯片组和灯光通过VBUS供电、关断灯光电源、允许后备电池充电。直到软件恢复运行重新接管电源。
2. 当后备电池电量失效后选择芯片组和灯光通过后备电池供电、禁止后备电池充电后将导致芯片组电源断开，进而被硬件置为1中的设置。
